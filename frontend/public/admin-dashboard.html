<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Dashboard</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Removed external resources.css, all styles are now in this file -->
  <style>
    /* 60-30-10 Color Palette */
    :root {
      --main-bg: #f7f8fa; /* 60% - light neutral background */
      --secondary: #2e8b57; /* 30% - rich green for panels/cards/nav */
      --accent: #ff9800; /* 10% - orange accent for buttons/highlights */
      --text-main: #222;
      --text-light: #fff;
      --card-bg: #fff;
      --shadow: 0 10px 30px rgba(0,0,0,0.08);
    }
    body {
      background: var(--main-bg);
      min-height: 100vh;
      font-family: 'Segoe UI', Arial, sans-serif;
      color: var(--text-main);
      margin: 0;
      padding: 0;
    }
    
    .admin-container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 20px;
    }
    .admin-header {
      background: var(--card-bg);
      border-radius: 20px 20px 0 0;
      padding: 30px 40px;
      box-shadow: var(--shadow);
    }
    .admin-header h1 {
      color: var(--secondary);
      font-size: 2.5em;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 15px;
    }
    .admin-header p {
      color: #666;
      font-size: 1.1em;
    }
    .admin-nav {
      background: var(--secondary);
      padding: 0 40px;
      border-bottom: 1px solid #e0e0e0;
    }
    .nav-tabs {
      display: flex;
      gap: 0;
    }
    .nav-tab {
      background: none;
      border: none;
      padding: 20px 30px;
      cursor: pointer;
      font-size: 16px;
      font-weight: 600;
      color: var(--text-light);
      border-bottom: 3px solid transparent;
      transition: all 0.3s ease;
      position: relative;
    }
    .nav-tab.active {
      color: var(--accent);
      border-bottom-color: var(--accent);
      background: rgba(255, 255, 255, 0.08);
    }
    .nav-tab:hover:not(.active) {
      color: var(--accent);
      background: rgba(255, 255, 255, 0.15);
    }
    .admin-content {
      background: var(--card-bg);
      border-radius: 0 0 20px 20px;
      min-height: 600px;
      box-shadow: var(--shadow);
    }
    .tab-content {
      display: none;
      padding: 40px;
      animation: fadeIn 0.3s ease;
    }
    .tab-content.active {
      display: block;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .add-resource-form {
      background: var(--card-bg);
      border-radius: 15px;
      padding: 30px;
      box-shadow: var(--shadow);
      margin-bottom: 30px;
    }
    .form-group {
      margin-bottom: 25px;
    }
    .form-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: #333;
    }
    .form-input, .form-textarea, .form-select {
      width: 100%;
      padding: 15px;
      border: 2px solid #e0e0e0;
      border-radius: 10px;
      font-size: 16px;
      transition: all 0.3s ease;
      background: white;
    }
    .form-input:focus, .form-textarea:focus, .form-select:focus {
      outline: none;
      border-color: #4ecdc4;
      box-shadow: 0 0 0 3px rgba(78, 205, 196, 0.1);
    }
    .form-textarea {
      resize: vertical;
      min-height: 120px;
    }
    .form-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }
    .btn {
      padding: 15px 30px;
      border: none;
      border-radius: 10px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      display: inline-block;
      text-align: center;
    }
    .btn-primary {
      background: var(--accent);
      color: var(--text-light);
    }
    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 25px rgba(255, 152, 0, 0.2);
    }
    .btn-danger {
      background: #e53935;
      color: var(--text-light);
    }
    .btn-danger:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 25px rgba(229, 57, 53, 0.2);
    }
    .btn-secondary {
      background: #e0e0e0;
      color: #222;
      border: 2px solid #bdbdbd;
    }
    .btn-secondary:hover {
      background: #bdbdbd;
      border-color: #888;
    }
    .resources-table {
      background: var(--card-bg);
      border-radius: 15px;
      overflow: hidden;
      box-shadow: var(--shadow);
    }
    .table-header {
      background: var(--secondary);
      color: var(--text-light);
      padding: 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .table-header h3 {
      font-size: 1.3em;
      margin: 0;
    }
    .search-box {
      display: flex;
      gap: 15px;
      align-items: center;
    }
    .search-input {
      padding: 10px 15px;
      border: none;
      border-radius: 8px;
      background: rgba(255, 255, 255, 0.9);
      width: 300px;
    }
    .table {
      width: 100%;
      border-collapse: collapse;
    }
    .table th, .table td {
      padding: 15px 20px;
      text-align: left;
      border-bottom: 1px solid #eee;
    }
    .table th {
      background: #f8f9fa;
      font-weight: 600;
      color: #333;
    }
    .table tr:hover {
      background: #f8f9fa;
    }
    .resource-actions {
      display: flex;
      gap: 10px;
    }
    .action-btn {
      padding: 8px 12px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.3s ease;
    }
    .edit-btn {
      background: var(--accent);
      color: var(--text-light);
    }
    .delete-btn {
      background: #e53935;
      color: var(--text-light);
    }
    .action-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    }
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 25px;
      margin-bottom: 30px;
    }
    .stat-card {
      background: var(--card-bg);
      border-radius: 15px;
      padding: 25px;
      box-shadow: var(--shadow);
      text-align: center;
      position: relative;
      overflow: hidden;
    }
    .stat-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, var(--secondary), var(--accent));
    }
    .stat-number {
      font-size: 3em;
      font-weight: bold;
      color: var(--secondary);
      margin-bottom: 10px;
    }
    .stat-label {
      font-size: 1.1em;
      color: #666;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    /* Only apply custom modal styles to #editModal, not Bootstrap modals */
    #editModal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(5px);
    }
    #editModal.active {
      display: flex;
      align-items: center;
      justify-content: center;
      animation: modalFadeIn 0.3s ease;
    }
    @keyframes modalFadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    #editModal .modal-content {
      background: white;
      border-radius: 20px;
      padding: 30px;
      width: 90%;
      max-width: 600px;
      max-height: 90vh;
      overflow-y: auto;
      animation: modalSlideIn 0.3s ease;
    }
    @keyframes modalSlideIn {
      from { transform: translateY(-30px) scale(0.9); }
      to { transform: translateY(0) scale(1); }
    }
    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 25px;
      padding-bottom: 15px;
      border-bottom: 2px solid #eee;
    }
    .modal-title {
      font-size: 1.5em;
      color: #333;
      margin: 0;
    }
    .close-btn {
      background: none;
      border: none;
      font-size: 24px;
      cursor: pointer;
      color: #999;
      transition: color 0.3s ease;
    }
    .close-btn:hover {
      color: #333;
    }
    .loading-overlay {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(255, 255, 255, 0.9);
      display: none;
      align-items: center;
      justify-content: center;
      border-radius: 15px;
      z-index: 900; /* below modal */
    }
    .loading-overlay.active {
      display: flex;
    }
    .spinner {
      border: 4px solid #f3f3f3;
      border-top: 4px solid #4ecdc4;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      animation: spin 1s linear infinite;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    @media (max-width: 768px) {
      .admin-container {
        padding: 10px;
      }
      .admin-header, .admin-nav, .tab-content {
        padding: 20px;
      }
      .form-row {
        grid-template-columns: 1fr;
      }
      .stats-grid {
        grid-template-columns: 1fr;
      }
      .search-box {
        flex-direction: column;
        align-items: stretch;
      }
      .search-input {
        width: 100%;
      }
      .table {
        font-size: 14px;
      }
      .table th, .table td {
        padding: 10px;
      }
    }
    .sidebar {
      min-height: 100vh;
      background: var(--secondary);
      color: var(--text-light);
      padding-top: 2rem;
    
    }
    .sidebar .profile {
      text-align: center;
      padding: 1rem;
      border-bottom: 1px solid rgba(255,255,255,0.1);
    }
    .sidebar .profile img {
      width: 70px;
      height: 70px;
      border-radius: 50%;
      margin-bottom: 0.5rem;
      border: 2px solid #00bfa5;
      object-fit: cover;
    }
    .sidebar a {
      color: var(--text-light);
      display: block;
      padding: 0.75rem 1.5rem;
      text-decoration: none;
      border-radius: 0.3rem;
      margin-bottom: 0.5rem;
      transition: background 0.2s;
    }
    .sidebar a.active, .sidebar a:hover {
      background: var(--accent);
      color: var(--text-light);
    }
    .dashboard-content {
      padding: 2rem;
    }
    .form-section {
      background: var(--card-bg);
      border-radius: 0.5rem;
      box-shadow: var(--shadow);
      padding: 2rem;
      margin-bottom: 2rem;
      margin-top: 5rem;
    }
    .form-section h2 {
      margin-bottom: 1.5rem;
      font-weight: 600;
    }
    .form-section .form-control,
    .form-section .form-select {
      border-radius: 0.375rem;
      border: 1px solid #ced4da;
      padding: 0.75rem;
    }
    .form-section .form-control:focus,
    .form-section .form-select:focus {
      border-color: #0d6efd;
      box-shadow: 0 0 0 0.2rem rgba(13, 110, 253, 0.25);
    }

/* Ensure modal displays properly */
.modal-dialog {
  max-width: 90vw;
}

.modal-lg {
  max-width: 800px;
}

/* Better form styling in modal */
.modal-body .form-label {
  font-weight: 600;
  margin-bottom: 0.5rem;
}

.modal-body .form-control,
.modal-body .form-select {
  border: 1px solid #ddd;
  border-radius: 0.375rem;
  padding: 0.75rem;
}

.modal-body .form-control:focus,
.modal-body .form-select:focus {
  border-color: #0d6efd;
  box-shadow: 0 0 0 0.2rem rgba(13, 110, 253, 0.25);
}

/* Responsive adjustments */
@media (max-width: 768px) {
  .modal-dialog {
    margin: 1rem;
  }
  
  .modal-body .row > .col-md-6 {
    margin-bottom: 1rem;
  }
}
.dashboard-header {
  border-bottom: 1px solid #e9ecef;
  margin-bottom: 2rem;
  padding-bottom: 1rem;
}
  </style>
</head>
<body>
  <div class="container-fluid">
    <div class="row">
      <!-- Sidebar -->
      <nav class="col-md-2 sidebar">
        <h4 class="text-center mb-4">Admin Panel</h4>
        <div class="profile">
          <img id="profile-picture" src="default-avatar.png" alt="Profile Picture">
        </div>
        <a href="#" class="nav-link active" data-section="profile"><span class="material-icons"></span> Profile</a>
        <a href="#" class="active" onclick="showSection('dashboard')">Dashboard</a>
        <a href="#" onclick="showSection('courses')">Courses</a>
        <a href="#" onclick="showSection('opportunities')">Opportunities</a>
        <a href="#" onclick="showSection('mentors')">Mentors</a>
        <a href="#" onclick="showSection('resources')">Resources</a>
        <a href="#" onclick="showSection('settings')">Settings</a>
        <a href="admin-login.html" onclick="logout()" class="text-danger mt-5">Logout</a>
      </nav>
      <!-- Main Content -->
      <main class="col-md-10 ms-sm-auto dashboard-content">
        <div id="dashboard-section" class="dashboard-header">
          <h2>Welcome, Admin!</h2>
          <p>This is the admin dashboard, use the sidebar to manage courses, opportunities, mentors, and platform settings.</p>
        </div>
        <div class="content">

        <!-- Admin Profile Section -->
        <div id="section-profile" class="form-section" style="display:none;">
          <h2>Profile</h2>
          <form id="mentor-profile-form" class="mb-4">
            <label class="form-label">Upload Profile Picture:</label>
            <input type="file" id="mentor-avatar-upload" class="form-control mb-2" accept="image/">
            <input type="text" id="mentor-name" class="form-control mb-2" placeholder="Name" required>
            <textarea id="mentor-bio" class="form-control mb-2" placeholder="About you"></textarea>
            <input type="text" id="mentor-social" class="form-control mb-2" placeholder="Social Links (comma separated)">
            <input type="text" id="mentor-work" class="form-control mb-2" placeholder="Work Links (comma separated)">
            <input type="url" id="mentor-calendar" class="form-control mb-2" placeholder="Calendar Link">
            <button type="submit" class="btn btn-primary">Save Profile</button>
          </form>
        </div>

        <!-- Courses Section -->
        <div id="courses-section" class="form-section" style="display:none;">
          <div class="d-flex justify-content-between align-items-center mb-3">
            <h3>Courses</h3>
            <button class="btn btn-success" onclick="showAddCourseForm()">+ Add Course</button>
          </div>
          <div id="courses-list"></div>
          <!-- Add/Edit Course Form Modal -->
          <div class="modal fade" id="courseModal" tabindex="-1" aria-labelledby="courseModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg" role="dialog" aria-modal="true" aria-labelledby="courseModalLabel">
              <div class="modal-content">
                <form id="course-form">
                  <div class="modal-header">
                    <h5 class="modal-title" id="courseModalLabel">Add/Edit Course</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                  </div>
                  <div class="modal-body">
                    <div class="row g-3">
                      <div class="col-md-6">
                        <input type="text" class="form-control" id="course-title" placeholder="Title" required>
                      </div>
                      <div class="col-md-6">
                        <input type="text" class="form-control" id="course-category" placeholder="Category" required>
                      </div>
                      <div class="col-md-6">
                        <input type="text" class="form-control" id="course-duration" placeholder="Duration (e.g. 4 weeks)" required>
                      </div>
                      <div class="col-md-6">
                        <input type="number" class="form-control" id="course-price" placeholder="Price (USD)" min="0" step="0.01">
                      </div>
                      <div class="col-12">
                        <textarea class="form-control" id="course-description" placeholder="Description" rows="3" required></textarea>
                      </div>
                      <div class="col-12">
                        <label class="form-label">Upload Materials (Videos, PDFs, etc.)</label>
                        <input type="file" class="form-control" id="course-materials" multiple>
                      </div>
                      <div class="col-12">
                        <label class="form-label">Upload Quiz (optional)</label>
                        <input type="file" class="form-control" id="course-quiz">
                      </div>
                      <div class="col-12">
                        <label class="form-label">Visibility</label>
                        <select class="form-select" id="course-visibility">
                          <option value="public">Public</option>
                          <option value="private">Private</option>
                        </select>
                      </div>
                      <div class="col-12">
                        <label class="form-label">Enrollment Options</label>
                        <select class="form-select" id="course-enrollment">
                          <option value="open">Open</option>
                          <option value="approval">Requires Approval</option>
                        </select>
                      </div>
                      <div class="col-12">
                        <label class="form-label">Certification Rules</label>
                        <input type="text" class="form-control" id="course-certification" placeholder="e.g. Complete all modules and quiz">
                      </div>
                    </div>
                  </div>
                  <div class="modal-footer">
                    <button type="submit" class="btn btn-primary">Save Course</button>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>
<!-- Opportunities Section -->
<div id="opportunities-section" class="form-section" style="display:none;">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h3>Opportunities</h3>
    <button class="btn btn-success" onclick="showAddOpportunityForm()">+ Post Opportunity</button>
  </div>
  <div class="mb-3">
    <label for="opportunity-filter" class="form-label">Filter by Type:</label>
    <select id="opportunity-filter" class="form-select">
      <option value="">All</option>
      <option value="Scholarship">Scholarship</option>
      <option value="Job">Job</option>
      <option value="Funding">Funding</option>
    </select>
  </div>
  <!-- Opportunities List -->
  <div id="opportunities-list"></div>

  <!-- Add/Edit Opportunity Modal -->
  <div class="modal fade" id="opportunityModal" tabindex="-1" aria-labelledby="opportunityModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered" role="dialog" aria-modal="true" aria-labelledby="opportunityModalLabel">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="opportunityModalLabel">Add Opportunity</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <form id="opportunity-form">
          <div class="modal-body">
            <!-- Title Field - Full Width -->
            <div class="mb-3">
              <label for="opportunity-title" class="form-label">Opportunity Title *</label>
              <input type="text" id="opportunity-title" class="form-control" placeholder="Enter the opportunity name/title" required>
            </div>
            
            <!-- Description Field - Full Width -->
            <div class="mb-3">
              <label for="opportunity-description" class="form-label">Description *</label>
              <textarea id="opportunity-description" class="form-control" rows="4" placeholder="Enter detailed description of the opportunity" required></textarea>
            </div>
            
            <!-- Two Column Layout for Other Fields -->
            <div class="row">
              <div class="col-md-6">
                <div class="mb-3">
                  <label for="opportunity-category" class="form-label">Category</label>
                  <input type="text" id="opportunity-category" class="form-control" placeholder="e.g., Technology, Business, Arts">
                </div>
                <div class="mb-3">
                  <label for="opportunity-deadline" class="form-label">Application Deadline</label>
                  <input type="date" id="opportunity-deadline" class="form-control">
                </div>
              </div>
              <div class="col-md-6">
                <div class="mb-3">
                  <label for="opportunity-type" class="form-label">Opportunity Type *</label>
                  <select id="opportunity-type" class="form-select" required>
                    <option value="">Select type</option>
                    <option value="Scholarship">Scholarship</option>
                    <option value="Job">Job</option>
                    <option value="Funding">Funding</option>
                  </select>
                </div>
                <div class="mb-3">
                  <label for="opportunity-link" class="form-label">Application Link</label>
                  <input type="url" id="opportunity-link" class="form-control" placeholder="https://example.com/apply">
                </div>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
            <button type="submit" class="btn btn-primary">Save Opportunity</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- Mentor Management Section -->
<div id="mentors-section" class="form-section" style="display:none;">
  <h3>Mentors</h3>
  <button class="btn btn-success mb-2" onclick="showMentorForm()">+ Add Mentor</button>
  <div id="mentors-list"></div>
</div>

<!-- Mentor Modal -->
<div class="modal fade" id="mentorModal" tabindex="-1" aria-labelledby="mentorModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="dialog" aria-modal="true" aria-labelledby="mentorModalLabel">
    <form id="mentor-form" enctype="multipart/form-data">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="mentorModalLabel">Add Mentor</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <input type="text" id="mentor-name" class="form-control mb-2" placeholder="Name" required>
          <input type="text" id="mentor-title" class="form-control mb-2" placeholder="Title">
          <input type="file" id="mentor-avatar" class="form-control mb-2">
          <input type="text" id="mentor-readmore" class="form-control mb-2" placeholder="Read More URL">
          <input type="text" id="mentor-calendar" class="form-control mb-2" placeholder="Calendar Booking URL">
          <textarea id="mentor-bio" class="form-control mb-2" placeholder="Bio"></textarea>
          <input type="text" id="mentor-tags" class="form-control mb-2" placeholder="Tags (comma separated)">
        </div>
        <div class="modal-footer">
          <button type="submit" class="btn btn-primary">Save Mentor</button>
        </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Admin Resources Section -->
  <div id="resources-section" class="form-section" style="display:none;">
    <div class="admin-container">
        <div class="admin-header">
            <div>
                <h1>‚öôÔ∏è Admin Resources</h1>
                <p>Manage your resource library</p>
            </div>
        </div>

        <div class="admin-nav">
            <div class="nav-tabs">
                <button class="nav-tab active" data-tab="overview">üìä Overview</button>
                <button class="nav-tab" data-tab="add">‚ûï Add Resource</button>
                <button class="nav-tab" data-tab="manage">üìù Manage Resources</button>
            </div>
        </div>

        <div class="admin-content">
            <!-- Overview Tab -->
            <div id="overview" class="tab-content active">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="totalResources">0</div>
                        <div class="stat-label">Total Resources</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="totalDownloads">0</div>
                        <div class="stat-label">Total Downloads</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="resourcesThisMonth">0</div>
                        <div class="stat-label">Added This Month</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="popularType">-</div>
                        <div class="stat-label">Popular Type</div>
                    </div>
                </div>

                <div class="resources-table">
                    <div class="table-header">
                        <h3>Recent Resources</h3>
                    </div>
                    <div id="recentResourcesContainer">
                        <div class="loading-overlay">
                            <div class="spinner"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Add Resource Tab -->
            <div id="add" class="tab-content">
                <div class="add-resource-form">
                    <h2 style="margin-bottom: 25px; color: #333;">‚ûï Add New Resource</h2>
                    <form id="addResourceForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="title">Title *</label>
                                <input type="text" id="title" name="title" class="form-input" required>
                            </div>
                            <div class="form-group">
                                <label for="type">Type *</label>
                                <select id="type" name="type" class="form-select" required>
                                    <option value="">Select Type</option>
                                    <option value="PDF">PDF</option>
                                    <option value="Video">Video</option>
                                    <option value="Document">Document</option>
                                    <option value="Presentation">Presentation</option>
                                    <option value="Audio">Audio</option>
                                    <option value="Image">Image</option>
                                    <option value="Link">Link</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="description">Description *</label>
                            <textarea id="description" name="description" class="form-textarea" 
                                      placeholder="Provide a detailed description of the resource..." required></textarea>
                        </div>

                        <div class="form-group">
                            <label for="url">URL *</label>
                            <input type="url" id="url" name="url" class="form-input" 
                                   placeholder="https://example.com/resource" required>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="category">Category</label>
                                <input type="text" id="category" name="category" class="form-input" 
                                       placeholder="e.g., Mathematics, Science, History">
                            </div>
                            <div class="form-group">
                                <label for="tags">Tags</label>
                                <input type="text" id="tags" name="tags" class="form-input" 
                                       placeholder="Comma-separated tags">
                            </div>
                        </div>

                        <div class="form-group" style="margin-top: 30px;">
                            <button type="submit" class="btn btn-primary" style="margin-right: 15px;">
                                üìÅ Add Resource
                            </button>
                            <button type="button" class="btn btn-secondary" onclick="document.getElementById('addResourceForm').reset();">
                                üîÑ Clear Form
                            </button>
                        </div>
                    </form>
                    
                    <div class="loading-overlay" id="addFormLoading">
                        <div class="spinner"></div>
                    </div>
                </div>
            </div>

            <!-- Manage Resources Tab -->
            <div id="manage" class="tab-content">
                <div class="resources-table">
                    <div class="table-header">
                        <h3>All Resources</h3>
                        <div class="search-box">
                            <input type="text" id="manageSearchInput" class="search-input" 
                                   placeholder="Search resources...">
                            <select id="manageTypeFilter" class="form-select" style="width: auto;">
                                <option value="">All Types</option>
                                <option value="PDF">PDF</option>
                                <option value="Video">Video</option>
                                <option value="Document">Document</option>
                                <option value="Presentation">Presentation</option>
                                <option value="Audio">Audio</option>
                                <option value="Image">Image</option>
                                <option value="Link">Link</option>
                            </select>
                        </div>
                    </div>
                    <div id="manageResourcesContainer" style="position: relative;">
                        <div class="loading-overlay">
                            <div class="spinner"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Resource Modal -->
    <div id="editModal" class="modal">
        <div class="modal-content" role="dialog" aria-modal="true" aria-labelledby="editResourceModalLabel">
            <div class="modal-header">
                <h2 class="modal-title">‚úèÔ∏è Edit Resource</h2>
                <button class="close-btn" onclick="closeEditModal()">&times;</button>
            </div>
            <form id="editResourceForm">
                <input type="hidden" id="editResourceId">
                <div class="form-row">
                    <div class="form-group">
                        <label for="editTitle">Title *</label>
                        <input type="text" id="editTitle" name="title" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label for="editType">Type *</label>
                        <select id="editType" name="type" class="form-select" required>
                            <option value="PDF">PDF</option>
                            <option value="Video">Video</option>
                            <option value="Document">Document</option>
                            <option value="Presentation">Presentation</option>
                            <option value="Audio">Audio</option>
                            <option value="Image">Image</option>
                            <option value="Link">Link</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label for="editDescription">Description *</label>
                    <textarea id="editDescription" name="description" class="form-textarea" required></textarea>
                </div>

                <div class="form-group">
                    <label for="editUrl">URL *</label>
                    <input type="url" id="editUrl" name="url" class="form-input" required>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="editCategory">Category</label>
                        <input type="text" id="editCategory" name="category" class="form-input">
                    </div>
                    <div class="form-group">
                        <label for="editTags">Tags</label>
                        <input type="text" id="editTags" name="tags" class="form-input">
                    </div>
                </div>

                <div class="form-group" style="margin-top: 30px;">
                    <button type="submit" class="btn btn-primary" style="margin-right: 15px;">
                        üíæ Update Resource
                    </button>
                    <button type="button" class="btn btn-secondary" onclick="closeEditModal()">
                        ‚ùå Cancel
                    </button>
                </div>
            </form>
            
            <div class="loading-overlay" id="editFormLoading">
                <div class="spinner"></div>
            </div>
        </div>
    </div>


          <!-- Settings Section -->
          <div id="settings-section" class="form-section" style="display:none;">
            <h3>Platform Settings</h3>
            <p>Settings for visibility, enrollment, certification, notifications, etc. (implement as needed)</p>
          </div>
        </main>
      </div>
    </div>
  <script>
    // Sidebar navigation
    function showSection(section) {
  // Hide all sections first
  document.getElementById('dashboard-section').style.display = 'none';
  document.getElementById('courses-section').style.display = 'none';
  document.getElementById('opportunities-section').style.display = 'none';
  document.getElementById('mentors-section').style.display = 'none';
  document.getElementById('settings-section').style.display = 'none';
  document.getElementById('resources-section').style.display = 'none';

  // Show the selected section
  document.getElementById(section + '-section').style.display = 'block';

  // Highlight active link
  document.querySelectorAll('.sidebar a').forEach(a => a.classList.remove('active'));
  document.querySelector('.sidebar a[onclick*="' + section + '"]').classList.add('active');

  // Load specific data for the section
  if (section === 'courses') loadCourses();
  if (section === 'opportunities') loadOpportunities();
  if (section === 'mentors') loadMentors();
  if (section === 'resources') {
    if (window.adminManager && window.adminManager.refresh) {
      window.adminManager.refresh();
    } else if (typeof loadResources === 'function') {
      loadResources();
    }
  }
}

    showSection('dashboard');

    // Logout function
    function logout() {
      localStorage.removeItem('adminToken');
    }

    // Profile Picture Upload
    document.getElementById('mentor-avatar-upload').addEventListener('change', function() {
      const file = this.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = e => {
          document.getElementById('profile-picture').src = e.target.result;
        };
        reader.readAsDataURL(file);
      }
    });

    // --- Courses ---
    let editingCourseId = null;

    async function loadCourses() {
      const res = await fetch('http://localhost:5000/api/admin/courses', {
        headers: { 'Authorization': 'Bearer ' + localStorage.getItem('adminToken') }
      });
      if (!res.ok) {
        const error = await res.json();
        alert('Error loading courses: ' + (error.error || res.statusText));
        return;
      }
      const courses = await res.json();
      document.getElementById('courses-list').innerHTML = courses.map(c =>
        `<div class="card mb-2">
          <div class="card-body">
            <h5 class="card-title">${c.title}</h5>
            <p class="card-text">${c.description}</p>
            <span class="badge bg-secondary">${c.category}</span>
            <span class="badge bg-info">${c.duration}</span>
            <span class="badge bg-success">$${c.price || 0}</span>
            <button class="btn btn-sm btn-outline-primary float-end ms-2" onclick="editCourse('${c._id}')">Edit</button>
            <button class="btn btn-sm btn-outline-danger float-end" onclick="deleteCourse('${c._id}')">Delete</button>
          </div>
        </div>`
      ).join('');
    }
    function showAddCourseForm() {
      editingCourseId = null;
      document.getElementById('course-form').reset();
      document.getElementById('courseModalLabel').textContent = 'Add Course';
      new bootstrap.Modal(document.getElementById('courseModal')).show();
    }

    async function editCourse(id) {
      editingCourseId = id;
      const res = await fetch('http://localhost:5000/api/admin/courses/' + id, {
        headers: { 'Authorization': 'Bearer ' + localStorage.getItem('adminToken') }
      });
      if (!res.ok) {
        alert('Failed to load course details');
        return;
      }
      const course = await res.json();
      document.getElementById('course-title').value = course.title || '';
      document.getElementById('course-category').value = course.category || '';
      document.getElementById('course-duration').value = course.duration || '';
      document.getElementById('course-price').value = course.price || '';
      document.getElementById('course-description').value = course.description || '';
      document.getElementById('course-visibility').value = course.visibility || 'public';
      document.getElementById('course-enrollment').value = course.enrollment || 'open';
      document.getElementById('course-certification').value = course.certification || '';
      document.getElementById('courseModalLabel').textContent = 'Edit Course';
      new bootstrap.Modal(document.getElementById('courseModal')).show();
    }

    document.getElementById('course-form').onsubmit = async function(e) {
      e.preventDefault();
      const formData = new FormData();
      formData.append('title', document.getElementById('course-title').value);
      formData.append('category', document.getElementById('course-category').value);
      formData.append('duration', document.getElementById('course-duration').value);
      formData.append('price', document.getElementById('course-price').value);
      formData.append('description', document.getElementById('course-description').value);
      formData.append('visibility', document.getElementById('course-visibility').value);
      formData.append('enrollment', document.getElementById('course-enrollment').value);
      formData.append('certification', document.getElementById('course-certification').value);

      // Materials
      const materials = document.getElementById('course-materials').files;
      for (let i = 0; i < materials.length; i++) {
        formData.append('materials', materials[i]);
      }
      // Quiz
      const quiz = document.getElementById('course-quiz').files[0];
      if (quiz) formData.append('quiz', quiz);

      let url = 'http://localhost:5000/api/admin/courses';
      let method = 'POST';
      if (editingCourseId) {
        url += '/' + editingCourseId;
        method = 'PUT';
      }

      const res = await fetch(url, {
        method,
        headers: { 'Authorization': 'Bearer ' + localStorage.getItem('adminToken') },
        body: formData
      });
      if (!res.ok) {
        const error = await res.json();
        alert('Error: ' + (error.error || res.statusText));
        return;
      }
      bootstrap.Modal.getInstance(document.getElementById('courseModal')).hide();
      loadCourses();
    };

    async function deleteCourse(id) {
      if (!confirm('Are you sure you want to delete this course?')) return;
      const res = await fetch('http://localhost:5000/api/admin/courses/' + id, {
        method: 'DELETE',
        headers: { 'Authorization': 'Bearer ' + localStorage.getItem('adminToken') }
      });
      if (res.ok) {
        loadCourses();
      } else {
        alert('Failed to delete course');
      }
    }
   // --- Opportunities Management ---
// Admin dashboard script section

let editingOpportunityId = null;

// Edit opportunity function
async function editOpportunity(id) {
  editingOpportunityId = id;
  const res = await fetch(`http://localhost:5000/api/admin/opportunities/${id}`, {
    headers: { 'Authorization': 'Bearer ' + localStorage.getItem('adminToken') }
  });
  
  if (!res.ok) {
    alert('Failed to load opportunity details');
    return;
  }
  
  const opp = await res.json();
  document.getElementById('opportunity-title').value = opp.title || '';
  document.getElementById('opportunity-description').value = opp.description || '';
  document.getElementById('opportunity-category').value = opp.category || '';
  document.getElementById('opportunity-deadline').value = opp.deadline || '';
  document.getElementById('opportunity-link').value = opp.link || '';
  document.getElementById('opportunity-type').value = opp.type || '';
  
  document.getElementById('opportunityModalLabel').textContent = 'Edit Opportunity';
  new bootstrap.Modal(document.getElementById('opportunityModal')).show();
}

// Delete opportunity function
async function deleteOpportunity(id) {
  if (!confirm('Are you sure you want to delete this opportunity?')) return;
  
  const res = await fetch(`http://localhost:5000/api/admin/opportunities/${id}`, {
    method: 'DELETE',
    headers: { 'Authorization': 'Bearer ' + localStorage.getItem('adminToken') }
  });
  
  if (res.ok) {
    loadOpportunities();
  } else {
    alert('Failed to delete opportunity');
  }
}

// Show add opportunity form
function showAddOpportunityForm() {
  editingOpportunityId = null;
  document.getElementById('opportunity-form').reset();
  document.getElementById('opportunityModalLabel').textContent = 'Add Opportunity';
  new bootstrap.Modal(document.getElementById('opportunityModal')).show();
}

// Load opportunities with optional filtering
async function loadOpportunities() {
  const filter = document.getElementById('opportunity-filter').value;
  const res = await fetch(`http://localhost:5000/api/admin/opportunities?type=${filter}`, {
    headers: { 'Authorization': 'Bearer ' + localStorage.getItem('adminToken') }
  });
  
  if (!res.ok) {
    const error = await res.json();
    alert('Error loading opportunities: ' + (error.error || res.statusText));
    return;
  }
  
  const opps = await res.json();
  document.getElementById('opportunities-list').innerHTML = opps.map(o =>
    `<div class="card mb-2">
      <div class="card-body">
        <h5 class="card-title">${o.title}</h5>
        <p class="card-text">${o.description}</p>
        <span class="badge bg-secondary">${o.category}</span>
        <span class="badge bg-info">${o.type}</span>
        <span class="badge bg-warning">${o.deadline ? new Date(o.deadline).toLocaleDateString() : 'No deadline'}</span>
        <div class="mt-2">
          <button class="btn btn-sm btn-outline-danger" onclick="deleteOpportunity('${o._id}')">Delete</button>
          <button class="btn btn-sm btn-outline-primary ms-2" onclick="editOpportunity('${o._id}')">Edit</button>
          <a href="${o.link}" class="btn btn-sm btn-outline-primary ms-2" target="_blank">View</a>
        </div>
      </div>
    </div>`
  ).join('');
}

// Single form submission handler (handles both create and edit)
document.getElementById('opportunity-form').onsubmit = async function(e) {
  e.preventDefault();
  
  const data = {
    title: document.getElementById('opportunity-title').value,
    description: document.getElementById('opportunity-description').value,
    category: document.getElementById('opportunity-category').value,
    deadline: document.getElementById('opportunity-deadline').value,
    link: document.getElementById('opportunity-link').value,
    type: document.getElementById('opportunity-type').value
  };

  let url = 'http://localhost:5000/api/admin/opportunities';
  let method = 'POST';
  
  if (editingOpportunityId) {
    url += '/' + editingOpportunityId;
    method = 'PUT';
  }

  const res = await fetch(url, {
    method,
    headers: {
      'Content-Type': 'application/json',
      'Authorization': 'Bearer ' + localStorage.getItem('adminToken')
    },
    body: JSON.stringify(data)
  });

  if (!res.ok) {
    let message = res.statusText;
    try {
      const err = await res.json();
      message = err.error || err.message || message;
    } catch(e) {}
    alert("Error: " + message);
    return;
  }

  // Reset editing state and close modal
  editingOpportunityId = null;
  bootstrap.Modal.getInstance(document.getElementById('opportunityModal')).hide();
  loadOpportunities();
};

// Add event listener for filter changes
document.getElementById('opportunity-filter').addEventListener('change', loadOpportunities);
    // admin mentor
    // Load mentorss
async function loadMentors() {
  const res = await fetch('http://localhost:5000/api/admin/mentors', {
    headers: { Authorization: 'Bearer ' + localStorage.getItem('adminToken') }
  });
  const mentors = await res.json();
  document.getElementById('mentors-list').innerHTML = mentors.map(m => `
    <div class="card mb-2">
      <div class="card-body">
        <strong>${m.name}</strong> <span class="text-muted">${m.title || ''}</span>
        <div>${m.bio || ''}</div>
        <div>Tags: ${Array.isArray(m.tags) ? m.tags.join(', ') : (m.tags || '')}</div>
        <button class="btn btn-sm btn-primary" onclick="editMentor('${m._id || m.id}')">Edit</button>
        <button class="btn btn-sm btn-danger" onclick="deleteMentor('${m._id || m.id}')">Delete</button>
      </div>
    </div>
  `).join('');
}

window.deleteMentor = async function(id) {
  if (!confirm('Delete this mentor?')) return;
  await fetch(`http://localhost:5000/api/admin/mentors/${id}`, {
    method: 'DELETE',
    headers: { 'Authorization': 'Bearer ' + localStorage.getItem('adminToken') }
  });
  loadMentors();
};

let editingMentorId = null;

function showMentorForm() {
  editingMentorId = null;
  // Only reset mentor modal fields, not profile fields
  document.querySelector('#mentor-form input#mentor-name').value = '';
  document.querySelector('#mentor-form input#mentor-title').value = '';
  document.querySelector('#mentor-form input#mentor-avatar').value = '';
  document.querySelector('#mentor-form input#mentor-readmore').value = '';
  document.querySelector('#mentor-form input#mentor-calendar').value = '';
  document.querySelector('#mentor-form textarea#mentor-bio').value = '';
  document.querySelector('#mentor-form input#mentor-tags').value = '';
  document.getElementById('mentorModalLabel').textContent = 'Add Mentor';
  new bootstrap.Modal(document.getElementById('mentorModal')).show();
}

window.editMentor = async function(id) {
  editingMentorId = id;
  const res = await fetch(`http://localhost:5000/api/admin/mentors/${id}`, {
    headers: { 'Authorization': 'Bearer ' + localStorage.getItem('adminToken') }
  });
  if (!res.ok) {
    let errMsg = 'Failed to load mentor details';
    try {
      const err = await res.text();
      errMsg += ': ' + err;
    } catch(e) {}
    alert(errMsg);
    return;
  }
  const m = await res.json();
  document.querySelector('#mentor-form input#mentor-name').value = m.name || '';
  document.querySelector('#mentor-form input#mentor-title').value = m.title || '';
  document.querySelector('#mentor-form input#mentor-avatar').value = '';
  document.querySelector('#mentor-form input#mentor-readmore').value = m.readMoreLink || '';
  document.querySelector('#mentor-form input#mentor-calendar').value = m.calendarLink || '';
  document.querySelector('#mentor-form textarea#mentor-bio').value = m.bio || '';
  document.querySelector('#mentor-form input#mentor-tags').value = Array.isArray(m.tags) ? m.tags.join(', ') : (m.tags || '');
  document.getElementById('mentorModalLabel').textContent = 'Edit Mentor';
  new bootstrap.Modal(document.getElementById('mentorModal')).show();
};

document.getElementById('mentor-form').onsubmit = async function(e) {
  e.preventDefault();

  // Always use FormData for both add and edit to support avatar upload
  const form = document.getElementById('mentor-form');
  const formData = new FormData();
  formData.append('name', form.querySelector('input#mentor-name').value);
  formData.append('title', form.querySelector('input#mentor-title').value);
  formData.append('readMoreLink', form.querySelector('input#mentor-readmore').value);
  formData.append('calendarLink', form.querySelector('input#mentor-calendar').value);
  formData.append('bio', form.querySelector('textarea#mentor-bio').value);
  formData.append('tags', form.querySelector('input#mentor-tags').value);
  const avatarFile = form.querySelector('input#mentor-avatar').files[0];
  if (avatarFile) {
    formData.append('avatar', avatarFile);
  }

  let url = 'http://localhost:5000/api/admin/mentors';
  let method = 'POST';
  if (editingMentorId) {
    url += '/' + editingMentorId;
    method = 'PUT';
  }

  const res = await fetch(url, {
    method,
    headers: {
      'Authorization': 'Bearer ' + localStorage.getItem('adminToken')
    },
    body: formData
  });

  if (!res.ok) {
    let errMsg = 'Unknown error';
    try {
      errMsg = await res.text();
    } catch(e) {}
    alert('Error saving mentor: ' + errMsg);
    return;
  }

  bootstrap.Modal.getInstance(document.getElementById('mentorModal')).hide();
  loadMentors();
};

  </script>
  <script>
    // --- Resource Management ---
    // Ensure AdminResourceManager is initialized and tab navigation works
    document.addEventListener('DOMContentLoaded', function() {
      if (window.AdminResourceManager) {
        window.adminManager = new AdminResourceManager();
        window.adminManager.init();
      } else if (typeof loadResources === 'function') {
        loadResources();
      }
      // Tab navigation for resources section
      const navTabs = document.querySelectorAll('.admin-nav .nav-tab');
      const tabContents = document.querySelectorAll('.admin-content .tab-content');
      navTabs.forEach(tab => {
        tab.addEventListener('click', function() {
          navTabs.forEach(t => t.classList.remove('active'));
          tab.classList.add('active');
          tabContents.forEach(tc => tc.classList.remove('active'));
          const target = tab.getAttribute('data-tab');
          document.getElementById(target).classList.add('active');
          // Refresh resource data when switching tabs
          if (window.adminManager && window.adminManager.refresh) {
            window.adminManager.refresh();
          } else if (typeof loadResources === 'function') {
            loadResources();
          }
        });
      });
    });
  </script>
  <script src="js/resources.js"></script>
  <!-- Bootstrap JS (for modal) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    // Hide all overlays when any modal is shown
    document.querySelectorAll('.modal').forEach(function(modal) {
      modal.addEventListener('show.bs.modal', function() {
        document.querySelectorAll('.loading-overlay').forEach(function(overlay) {
          overlay.classList.remove('active');
        });
      });
    });
  </script>
</body>
</html>